function [BW,mean_height,maskedImage] = maskBlack(X)
%segmentImage Segment image using auto-generated code from imageSegmenter app
%  [BW,MASKEDIMAGE] = segmentImage(X) segments image X using auto-generated
%  code from the imageSegmenter app. The final segmentation is returned in
%  BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 04-Jan-2023
%----------------------------------------------------


% Adjust data to span data range.
X = imadjust(X);

% Graph cut
foregroundInd = [91251 91252 91749 91752 91753 91754 91755 91756 91757 91758 91759 91760 91761 91762 91763 92249 92264 92265 92266 92267 92268 92269 92270 92749 92771 92772 92773 92774 92775 92776 92777 92778 92779 92780 92781 92782 92783 92785 92786 92787 92788 92789 92790 92791 92792 92794 92795 93295 93297 93298 93299 93300 93301 93302 93303 93749 93803 93804 93805 93806 93807 93808 93809 94249 94309 94809 95249 95309 96249 96309 97250 97309 97809 98750 98809 99309 100250 100309 100810 101250 102310 102750 102810 104250 104310 105310 105750 106750 106810 107310 108250 108310 108810 109310 109750 109811 110311 110750 111311 111811 111812 112250 112312 112812 113250 113312 113812 114250 114312 114812 115250 115312 116251 116312 116812 117751 117812 118812 119251 119812 120751 121312 122312 122751 123751 123812 124812 125751 126313 127313 127751 128313 128751 129314 129751 129814 130815 131251 131315 132315 132751 132815 134250 135750 135815 136316 136816 137250 137316 138316 138750 139316 139816 140250 140816 141316 141750 142317 142750 143317 143817 144250 144749 144817 145817 146249 146817 147249 147317 148317 148749 148817 149248 149317 149817 150248 150317 150817 151248 151317 152247 152317 152746 152817 153246 153746 153817 154246 154317 154746 154817 155246 155247 155248 155249 155250 155251 155252 155253 155254 155256 155258 155259 155317 155761 155762 155764 155766 155768 155770 155771 155773 155776 155777 155817 156279 156280 156282 156283 156285 156316 156317 156787 156788 156790 156792 156793 156795 156797 156813 156814 156815 156816 157300 157301 157303 157304 157306 157308 157309 157310 157311 157312 ];
backgroundInd = [75248 75249 75250 75252 75253 75255 75256 75258 75260 75262 75264 75265 75267 75269 75271 75273 75274 75277 75279 75280 75283 75285 75287 75291 75293 75746 75747 75797 75813 75814 75815 75816 75817 75818 75819 76237 76238 76239 76240 76241 76242 76243 76245 76300 76303 76306 76320 76321 76322 76323 76324 76325 76327 76734 76735 76736 76737 76809 76810 76813 76815 76827 76828 76829 76830 76831 76832 76833 76834 76835 76836 76837 77232 77233 77337 77338 77339 77731 77732 77839 77840 78229 78230 78340 78342 78727 78728 78843 79227 79343 79344 79726 79845 80225 80725 80845 81224 81346 81724 81846 82222 82223 82346 82722 82847 83222 83348 83722 84222 84348 84848 85222 85722 85849 86222 86722 86849 87222 88349 88722 89222 89349 90222 90849 91722 91849 92722 93349 94222 94349 94849 95222 95849 96222 96349 96849 97222 97349 97849 98349 99222 99349 99849 100223 100849 101223 101349 102349 102723 103349 103724 104349 104724 105348 105724 106348 107224 107848 108224 109348 109724 110724 111348 112224 113224 113348 114724 114848 115724 116848 117224 117724 118348 119224 119848 120224 121224 121348 122224 122348 123224 123724 123848 124848 125224 125848 126224 126849 128224 128349 129349 129724 131224 131349 132849 133724 134349 135224 135349 136724 136849 137849 138724 138849 139849 140224 140349 141724 141849 143349 143724 144849 145724 146849 147724 148849 149724 150849 151224 152349 153724 153849 154349 154724 155349 156349 156724 156849 157724 157849 158849 159224 159849 160224 161224 161349 162224 162349 163224 163849 164849 166349 167849 168849 169349 170349 170848 171224 171348 171848 172224 172348 172848 173224 173724 173848 174724 174847 175224 176224 176346 176724 176846 177724 178224 178346 178724 178725 178727 179229 179231 179234 179237 179240 179267 179271 179275 179280 179283 179288 179291 179294 179296 179298 179300 179301 179303 179306 179345 179743 179745 179748 179750 179753 179756 179759 179762 179801 179802 179803 179804 179805 180305 180306 180345 180806 180807 180808 180809 180810 180811 180812 180813 180814 180815 180845 181315 181316 181317 181318 181344 181843 181844 182319 182321 182322 182323 182334 182336 182337 182338 182339 182340 182341 182342 182824 182825 182827 182828 182830 182831 182832 ];
L = superpixels(X,1350);
BW = lazysnapping(X,L,foregroundInd,backgroundInd);
se = strel("square",5);
BW = imopen(BW,se);
% Create masked image.
maskedImage = X;
maskedImage(~BW) = 0;

% calculate the averag height of black section
x = sum(BW,2);
blackIndex = find(x>0);
mean_height = mean(blackIndex);
end

